<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataGrid Search Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
        }
        .test-results {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 4px;
            margin-top: 15px;
            font-family: monospace;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” DataGrid Search Functionality Test</h1>
        
        <div class="test-section">
            <h2>ğŸ“‹ DataGrid with Search (Paginator)</h2>
            <p>This demonstrates the search functionality integrated into the DataGridPaginator component.</p>
            <div id="paginator-container"></div>
        </div>

        <div class="test-section">
            <h2>ğŸ§ª Search API Test</h2>
            <button onclick="testSearchAPI()">Test Search Methods</button>
            <div id="api-test-results" class="test-results"></div>
        </div>
    </div>

    <script type="module">
        import { DataGridPaginator } from './dist/datagridpaginator.js';

        const testData = [
            { id: 1, position: "Software Engineer", company: "TechCorp", email: "john.doe@techcorp.com", isDisabled: false },
            { id: 2, position: "Product Manager", company: "InnovateInc", email: "jane.smith@innovate.com", isDisabled: false },
            { id: 3, position: "Senior Developer", company: "CodeWorks", email: "bob.johnson@codeworks.com", isDisabled: false },
            { id: 4, position: "UX Designer", company: "DesignStudio", email: "alice.brown@design.com", isDisabled: false },
            { id: 5, position: "Data Scientist", company: "DataCorp", email: "charlie.wilson@datacorp.com", isDisabled: false },
            { id: 6, position: "DevOps Engineer", company: "CloudTech", email: "diana.davis@cloudtech.com", isDisabled: true },
            { id: 7, position: "Frontend Developer", company: "WebSolutions", email: "frank.miller@websol.com", isDisabled: false },
            { id: 8, position: "Backend Engineer", company: "ServerSide", email: "grace.taylor@serverside.com", isDisabled: false }
        ];

        const testSchema = {
            id: { 
                type: 'number', 
                displayName: 'ID', 
                htmlElement: 'input', 
                htmlType: 'number', 
                searchable: false,
                canFilter: false,
                css: { readonly: true } 
            },
            position: { 
                type: 'string', 
                displayName: 'Position', 
                htmlElement: 'input', 
                htmlType: 'text', 
                searchable: true,
                canFilter: true,
                css: { placeholder: 'Enter position' } 
            },
            company: { 
                type: 'string', 
                displayName: 'Company', 
                htmlElement: 'input', 
                htmlType: 'text', 
                searchable: true,
                canFilter: true,
                css: { placeholder: 'Enter company' } 
            },
            email: { 
                type: 'email', 
                displayName: 'Email', 
                htmlElement: 'input', 
                htmlType: 'email', 
                searchable: true,
                canFilter: true,
                css: { placeholder: 'Enter email' } 
            }
        };

        // Initialize DataGrid Paginator with search capability
        const paginatorConfig = {
            schema: testSchema,
            data: testData,
            pageSize: 4
        };

        const paginator = new DataGridPaginator(paginatorConfig);
        document.getElementById('paginator-container').appendChild(paginator.getElement());
        
        console.log('DataGrid Search Test initialized');
        console.log('Try searching for terms like: "Engineer", "TechCorp", "john", etc.');

        // Make search API test function global
        window.testSearchAPI = function() {
            const resultsDiv = document.getElementById('api-test-results');
            let results = '';
            
            try {
                // Test basic search functionality
                results += '=== Testing Search API ===\n\n';
                
                // Test search input functionality
                results += '0. Testing Search Input:\n';
                const searchInput = paginator.container.querySelector('[data-search-input]');
                if (searchInput) {
                    results += `   âœ… Search input found: ${searchInput.tagName}\n`;
                    results += `   âœ… Input type: ${searchInput.type}\n`;
                    results += `   âœ… Input placeholder: "${searchInput.placeholder}"\n`;
                    results += `   âœ… Current value: "${searchInput.value}"\n`;
                    results += `   âœ… Can focus: ${searchInput.disabled ? 'NO (disabled)' : 'YES'}\n`;
                } else {
                    results += `   âŒ Search input not found!\n`;
                }
                results += '\n';
                
                // Test 1: Search for "Engineer"
                results += '1. Searching for "Engineer":\n';
                const engineerResults = paginator.filterData();
                paginator.searchTerm = 'Engineer';
                const filteredEngineers = paginator.filterData();
                results += `   Found ${filteredEngineers.length} matches out of ${engineerResults.length} total records\n`;
                filteredEngineers.forEach(record => {
                    results += `   - ${record.position} at ${record.company}\n`;
                });
                results += '\n';
                
                // Test 2: Search for company
                results += '2. Searching for "TechCorp":\n';
                paginator.searchTerm = 'TechCorp';
                const companyResults = paginator.filterData();
                results += `   Found ${companyResults.length} matches\n`;
                companyResults.forEach(record => {
                    results += `   - ${record.position} at ${record.company}\n`;
                });
                results += '\n';
                
                // Test 3: Clear search
                results += '3. Clearing search:\n';
                paginator.searchTerm = '';
                const allResults = paginator.filterData();
                results += `   Total records available: ${allResults.length}\n\n`;
                
                // Test searchable fields
                results += '4. Searchable fields:\n';
                const searchableFields = paginator.getSearchableFields();
                results += `   ${searchableFields.join(', ')}\n\n`;
                
                // Test search debounce
                results += '5. Search Input Event Test:\n';
                if (searchInput) {
                    searchInput.value = 'test';
                    const inputEvent = new Event('input', { bubbles: true });
                    searchInput.dispatchEvent(inputEvent);
                    results += `   âœ… Input event dispatched, search term should update in 300ms\n`;
                    results += `   âœ… Current paginator searchTerm: "${paginator.searchTerm}"\n`;
                } else {
                    results += `   âŒ Cannot test input events - search input not found\n`;
                }
                results += '\n';
                
                results += 'âœ… Search API tests completed successfully!\n';
                results += '\nğŸ“ Try typing in the search box above to test real-time search!';
                
            } catch (error) {
                results += `âŒ Error during testing: ${error.message}\n`;
                results += `Stack trace: ${error.stack}`;
            }
            
            resultsDiv.textContent = results;
        };
    </script>
</body>
</html>