<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataGridPaginator Smoke Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .pass { background: #d4edda; border: 1px solid #c3e6cb; color: #155724; }
        .fail { background: #f8d7da; border: 1px solid #f5c6cb; color: #721c24; }
        .info { background: #d1ecf1; border: 1px solid #bee5eb; color: #0c5460; }
        #test-container { margin: 20px 0; }
    </style>
</head>
<body>
    <h1>ðŸ§ª DataGridPaginator Smoke Test</h1>
    <div id="test-results"></div>
    <div id="test-container"></div>

    <script src="./positions-data.js"></script>
    <script type="module">
        import { DataGridPaginator } from './dist/datagridpaginator.js';

        const results = [];
        
        function addResult(test, status, message) {
            results.push({ test, status, message });
            const resultsDiv = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = `test-result ${status}`;
            div.innerHTML = `<strong>${test}:</strong> ${message}`;
            resultsDiv.appendChild(div);
        }

        // Wait for data to load
        setTimeout(() => {
            runTests();
        }, 100);

        async function runTests() {
            addResult('Data Loading', 'info', 'Starting tests...');
            
            // Test 1: Data availability
            try {
                if (window.dataGridData && window.dataGridData.positions) {
                    addResult('Data Loading', 'pass', `Loaded ${window.dataGridData.positions.data.length} records`);
                } else {
                    addResult('Data Loading', 'fail', 'No data found');
                    return;
                }
            } catch (error) {
                addResult('Data Loading', 'fail', `Error: ${error.message}`);
                return;
            }

            // Test 2: Basic paginator creation
            try {
                const paginator = DataGridPaginator.createFromData(window.dataGridData, {
                    pageSize: 5,
                    showCheckboxes: true,
                    showAddButton: true
                });
                
                const container = document.getElementById('test-container');
                container.appendChild(paginator.getElement());
                
                addResult('Paginator Creation', 'pass', 'DataGridPaginator created successfully');
                
                // Test 3: Page size selector
                setTimeout(() => {
                    const pageSizeSelect = container.querySelector('#pageSizeSelect');
                    if (pageSizeSelect) {
                        addResult('Page Size Selector', 'pass', 'Page size selector found with options: ' + Array.from(pageSizeSelect.options).map(o => o.value).join(', '));
                        
                        // Test changing page size
                        pageSizeSelect.value = '10';
                        pageSizeSelect.dispatchEvent(new Event('change'));
                        setTimeout(() => {
                            addResult('Page Size Change', 'pass', 'Page size changed to 10 successfully');
                        }, 100);
                    } else {
                        addResult('Page Size Selector', 'fail', 'Page size selector not found');
                    }
                    
                    // Test 4: Master checkbox
                    const masterCheckbox = container.querySelector('#masterCheckbox');
                    if (masterCheckbox) {
                        addResult('Master Checkbox', 'pass', 'Master checkbox found in header');
                        
                        // Test checking master checkbox
                        masterCheckbox.checked = true;
                        masterCheckbox.dispatchEvent(new Event('change'));
                        setTimeout(() => {
                            addResult('Master Checkbox Functionality', 'pass', 'Master checkbox event triggered');
                        }, 100);
                    } else {
                        addResult('Master Checkbox', 'fail', 'Master checkbox not found');
                    }
                    
                    // Test 5: Row checkboxes
                    const rowCheckboxes = container.querySelectorAll('.record-checkbox');
                    if (rowCheckboxes.length > 0) {
                        addResult('Row Checkboxes', 'pass', `Found ${rowCheckboxes.length} row checkboxes`);
                    } else {
                        addResult('Row Checkboxes', 'fail', 'No row checkboxes found');
                    }
                    
                    // Test 6: Add button
                    const addBtn = container.querySelector('#addRecordBtn');
                    if (addBtn) {
                        addResult('Add Button', 'pass', 'Add record button found');
                    } else {
                        addResult('Add Button', 'fail', 'Add record button not found');
                    }
                    
                    // Test 7: Pagination controls
                    const paginationControls = container.querySelector('.pagination-controls');
                    if (paginationControls) {
                        const pageButtons = paginationControls.querySelectorAll('.pagination-btn');
                        addResult('Pagination Controls', 'pass', `Found pagination controls with ${pageButtons.length} buttons`);
                    } else {
                        addResult('Pagination Controls', 'fail', 'Pagination controls not found');
                    }
                    
                    addResult('Test Complete', 'info', `Completed ${results.length} tests`);
                }, 200);
                
            } catch (error) {
                addResult('Paginator Creation', 'fail', `Error: ${error.message}`);
            }
        }
    </script>
</body>
</html>